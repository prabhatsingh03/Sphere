<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}PO Management System{% endblock %}</title>
  <link rel="shortcut icon" href="https://www.simonindia.com/favicon.ico" type="image/x-icon">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'sans': ['Inter', 'system-ui', 'sans-serif'],
            'mono': ['JetBrains Mono', 'monospace'],
          },
          screens: {
            'xs': '475px',
            'sm': '640px',
            'md': '768px',
            'lg': '1024px',
            'xl': '1280px',
            '2xl': '1536px',
          },
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            },
            secondary: {
              50: '#f8fafc',
              100: '#f1f5f9',
              200: '#e2e8f0',
              300: '#cbd5e1',
              400: '#94a3b8',
              500: '#64748b',
              600: '#475569',
              700: '#334155',
              800: '#1e293b',
              900: '#0f172a',
            }
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-in-out',
            'slide-up': 'slideUp 0.3s ease-out',
            'slide-down': 'slideDown 0.3s ease-out',
            'bounce-in': 'bounceIn 0.6s ease-out',
            'pulse-glow': 'pulseGlow 2s infinite',
            'float': 'float 3s ease-in-out infinite',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' }
            },
            slideUp: {
              '0%': { transform: 'translateY(20px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' }
            },
            slideDown: {
              '0%': { transform: 'translateY(-20px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' }
            },
            bounceIn: {
              '0%': { transform: 'scale(0.3)', opacity: '0' },
              '50%': { transform: 'scale(1.05)' },
              '70%': { transform: 'scale(0.9)' },
              '100%': { transform: 'scale(1)', opacity: '1' }
            },
            pulseGlow: {
              '0%, 100%': { boxShadow: '0 0 5px rgba(59, 130, 246, 0.5)' },
              '50%': { boxShadow: '0 0 20px rgba(59, 130, 246, 0.8)' }
            },
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' }
            }
          }
        }
      }
    }
  </script>
  
  <!-- Modern Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Custom Styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  
  <!-- Chart.js Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
  
  <!-- Chart.js loading verification -->
  <script>
    window.ChartJSLoaded = false;
    window.Chart = null;
    
    function waitForChartJS(maxAttempts = 20, interval = 300) {
      return new Promise((resolve, reject) => {
        let attempts = 0;
        
        const checkChartJS = () => {
          attempts++;
          
          console.log(`Attempt ${attempts}: Checking for Chart.js...`);
          console.log('Chart type:', typeof Chart);
          console.log('Chart value:', Chart);
          
          // Check if Chart.js is available
          if (typeof Chart !== 'undefined' && Chart) {
            console.log(`Chart.js found after ${attempts} attempts`);
            window.ChartJSLoaded = true;
            window.Chart = Chart;
            resolve(Chart);
            return;
          }
          
          if (attempts >= maxAttempts) {
            console.error(`Chart.js not found after ${maxAttempts} attempts`);
            reject(new Error('Chart.js not available'));
            return;
          }
          
          setTimeout(checkChartJS, interval);
        };
        
        checkChartJS();
      });
    }
    
    // Wait for Chart.js to be available
    waitForChartJS().then(() => {
      console.log('Chart.js loaded and ready to use');
    }).catch(error => {
      console.error('Chart.js loading failed:', error);
      // Try fallback CDN
      console.log('Trying fallback Chart.js CDN...');
      const fallbackScript = document.createElement('script');
      fallbackScript.src = 'https://unpkg.com/chart.js@4.4.0/dist/chart.umd.js';
      fallbackScript.onload = () => {
        console.log('Fallback Chart.js loaded, retrying...');
        waitForChartJS().then(() => {
          console.log('Chart.js loaded from fallback CDN');
        }).catch(fallbackError => {
          console.error('Chart.js failed to load from all sources:', fallbackError);
        });
      };
      fallbackScript.onerror = () => {
        console.error('Failed to load Chart.js from fallback CDN');
      };
      document.head.appendChild(fallbackScript);
    });
  </script>
</head>

<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen font-sans">
  <!-- Modern Navigation Header -->
  <header class="bg-white/80 backdrop-blur-lg border-b border-slate-200/60 sticky top-0 z-50 animate-slide-down">
    <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-8">
      <div class="flex justify-between items-center h-14 sm:h-16">
        <!-- Logo Section -->
        <div class="flex items-center space-x-2 sm:space-x-4 animate-fade-in">
          <div class="flex items-center space-x-2 sm:space-x-3">
            <div class="relative">
              <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="h-8 sm:h-10 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300">
              <div class="absolute -top-1 -right-1 w-2 h-2 sm:w-3 sm:h-3 bg-green-400 rounded-full animate-pulse"></div>
            </div>
            <div class="hidden xs:block">
              <h1 class="text-sm sm:text-xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 bg-clip-text text-transparent leading-tight">
                SPHERE
              </h1>
              <p class="text-xs text-slate-500 font-medium hidden sm:block">Smart Platform for Harmonized E-Procurement & Resource Exchange</p>
            </div>
          </div>
        </div>
        
        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="sm:hidden p-2 text-slate-600 hover:text-primary-600 transition-colors duration-200">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        
        <!-- Desktop Right Section -->
        <div class="hidden sm:flex items-center space-x-2 lg:space-x-4">
          {% if session.logged_in %}
            <!-- Notifications -->
            {% block notifications %}{% endblock %}
            
            <!-- User Menu -->
            <div class="flex items-center space-x-2 lg:space-x-3 px-2 lg:px-3 py-1.5 lg:py-2 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl border border-slate-200 hover:shadow-md transition-all duration-300 animate-fade-in">
              <div class="w-7 h-7 lg:w-8 lg:h-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg flex items-center justify-center text-white shadow-lg">
                <i class="fas fa-user text-xs lg:text-sm"></i>
              </div>
              <div class="hidden md:block">
                <span class="text-xs lg:text-sm font-semibold text-slate-700">{{ session.user_name or 'User' }}</span>
                <p class="text-xs text-slate-500 hidden lg:block">{{ session.user_role or 'User' }}</p>
              </div>
            </div>
            
            <!-- Admin Links -->
            {% if session.user_role == 'Admin' %}
            <a href="{{ url_for('user_configuration') }}" 
               class="flex items-center space-x-1 lg:space-x-2 px-3 lg:px-4 py-1.5 lg:py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 animate-fade-in">
              <i class="fas fa-users-cog text-xs lg:text-sm"></i>
              <span class="hidden md:inline text-xs lg:text-sm font-medium">Users</span>
            </a>
            {% endif %}
            
            <!-- Logout Button -->
            <a href="{{ url_for('logout') }}" 
               class="flex items-center space-x-1 lg:space-x-2 px-3 lg:px-4 py-1.5 lg:py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 animate-fade-in">
              <i class="fas fa-sign-out-alt text-xs lg:text-sm"></i>
              <span class="hidden md:inline text-xs lg:text-sm font-medium">Logout</span>
            </a>
          {% endif %}
        </div>
      </div>
      
      <!-- Mobile Menu -->
      <div id="mobile-menu" class="sm:hidden hidden border-t border-slate-200 py-3 space-y-3">
        {% if session.logged_in %}
          <!-- Mobile User Info -->
          <div class="flex items-center space-x-3 px-3 py-2 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl">
            <div class="w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg flex items-center justify-center text-white shadow-lg">
              <i class="fas fa-user text-sm"></i>
            </div>
            <div>
              <span class="text-sm font-semibold text-slate-700">{{ session.user_name or 'User' }}</span>
              <p class="text-xs text-slate-500">{{ session.user_role or 'User' }}</p>
            </div>
          </div>
          
          <!-- Mobile Admin Links -->
          {% if session.user_role == 'Admin' %}
          <a href="{{ url_for('user_configuration') }}" 
             class="flex items-center justify-center space-x-2 w-full px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
            <i class="fas fa-users-cog"></i>
            <span class="font-medium">User Management</span>
          </a>
          {% endif %}
          
          <!-- Mobile Notifications -->
          <div class="px-3">
            {% block mobile_notifications %}{% endblock %}
          </div>
          
          <!-- Mobile Logout -->
          <a href="{{ url_for('logout') }}" 
             class="flex items-center justify-center space-x-2 w-full px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-lg">
            <i class="fas fa-sign-out-alt"></i>
            <span class="font-medium">Logout</span>
          </a>
        {% endif %}
      </div>
    </div>
  </header>

  <!-- Main Content Area -->
  <main class="flex-1 relative">
    <!-- Flash Messages (Top-right) -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div id="flash-container" style="position:fixed; top:16px; right:16px; z-index:9999; width: min(92vw, 420px); display:flex; flex-direction:column; gap:8px;">
        {% for category, msg in messages %}
          <div style="display:flex; align-items:center; gap:12px; background:#fff; border-left:4px solid {% if category == 'error' %}#ef4444{% elif category == 'success' %}#22c55e{% elif category == 'warning' %}#f59e0b{% else %}#3b82f6{% endif %}; border-radius:12px; box-shadow:0 10px 15px rgba(0,0,0,0.1); padding:12px 16px;">
            <div style="width:32px; height:32px; border-radius:8px; display:flex; align-items:center; justify-content:center; background:{% if category == 'error' %}linear-gradient(135deg,#ef4444,#dc2626){% elif category == 'success' %}linear-gradient(135deg,#22c55e,#16a34a){% elif category == 'warning' %}linear-gradient(135deg,#f59e0b,#d97706){% else %}linear-gradient(135deg,#3b82f6,#2563eb){% endif %};">
              <i class="fas {% if category == 'error' %}fa-exclamation-circle{% elif category == 'success' %}fa-check-circle{% elif category == 'warning' %}fa-exclamation-triangle{% else %}fa-info-circle{% endif %}" style="color:#fff; font-size:14px;"></i>
            </div>
            <div style="flex:1; min-width:0; color:{% if category == 'error' %}#b91c1c{% elif category == 'success' %}#15803d{% elif category == 'warning' %}#b45309{% else %}#334155{% endif %}; font-size:14px; font-weight:600; line-height:1.4;">{{ msg }}</div>
            <button onclick="this.parentElement.remove()" style="width:24px; height:24px; border:none; border-radius:9999px; background:#f1f5f9; color:#94a3b8; cursor:pointer; display:flex; align-items:center; justify-content:center;">
              <i class="fas fa-times" style="font-size:12px;"></i>
            </button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% endwith %}

    <!-- Page Content -->
    <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-6 lg:py-8">
      {% block content %}{% endblock %}
    </div>
  </main>

  <!-- Modern Footer -->
  <footer class="bg-white/80 backdrop-blur-lg border-t border-slate-200/60 mt-auto">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
        <div class="flex items-center space-x-2">
          <div class="w-6 h-6 bg-gradient-to-br from-primary-500 to-primary-600 rounded-md flex items-center justify-center">
            <i class="fas fa-building text-white text-xs"></i>
          </div>
          <p class="text-sm text-slate-600 font-medium">&copy; 2025 Simon India Limited. All rights reserved.</p>
        </div>
        <div class="flex items-center space-x-6">
          <a href="{{ url_for('documentation') }}" class="text-sm text-slate-500 hover:text-primary-600 transition-colors duration-200 font-medium">
            Documentation - Approval Matrix
          </a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      
      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', function() {
          mobileMenu.classList.toggle('hidden');
          
          // Animate menu icon
          const icon = mobileMenuBtn.querySelector('svg');
          if (mobileMenu.classList.contains('hidden')) {
            icon.style.transform = 'rotate(0deg)';
          } else {
            icon.style.transform = 'rotate(90deg)';
          }
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
          if (!mobileMenuBtn.contains(e.target) && !mobileMenu.contains(e.target)) {
            mobileMenu.classList.add('hidden');
            const icon = mobileMenuBtn.querySelector('svg');
            icon.style.transform = 'rotate(0deg)';
          }
        });
      }
    });
  </script>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>


</html>
